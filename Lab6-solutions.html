<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.460">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lab 6 - Solutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="Lab6-solutions_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab6-solutions_files/libs/quarto-html/quarto.js"></script>
<script src="Lab6-solutions_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab6-solutions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lab6-solutions_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lab6-solutions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab6-solutions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lab6-solutions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lab6-solutions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lab6-solutions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 6 - Solutions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="z-tests-when-we-know-something-about-the-distribution-of-the-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> <span class="math inline">\(z\)</span>-tests (when we know something about the distribution of the data)</h1>
<section id="overview-of-the-theory" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="overview-of-the-theory">Overview of the theory</h3>
<p>As you know from the Lecture Notes, we use <span class="math inline">\(z\)</span>-tests if we either know that the data is distributed normally or if the sample is large enough so we may assume that its averaged value is distributed normally according to the central limit theorem (which we will discuss next week). Note that, to use <span class="math inline">\(z\)</span>-tests, we have to know the variance of the distribution.</p>
<p>Recall the main quantities we may need:</p>
<section id="test-statistic" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="test-statistic">1. Test statistic</h4>
<p>E.g. in the case of one sample, it’s</p>
<p><span id="eq-z-stat"><span class="math display">\[
z=\frac{\bar{x}-\mu}{\dfrac{\sigma}{\sqrt{n}}}
\tag{1}\]</span></span></p>
<p>This works e.g.&nbsp;for the estimation of <span class="math inline">\(\mu\)</span> of <span class="math inline">\(n\)</span> observations from <span class="math inline">\(\mathcal{N}(\mu, \sigma^2)\)</span> (when <span class="math inline">\(\sigma^2\)</span> is known); and this also works for large samples.</p>
</section>
<section id="p-value" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="p-value">2. <span class="math inline">\(p\)</span>-value</h4>
<p>Informally speaking, <span class="math inline">\(p\)</span>-value describes the area of the “tail” of distribution bounded by the test statistic. On the diagram below, the tails are shaded in pink. Recall that <span class="math inline">\(\varphi(z)=f_Z(z)\)</span> is the PDF of the <strong>standard normal distribution</strong>, where <span class="math inline">\(Z\sim \mathcal{N}(0,1)\)</span>. The pink areas are then related to the CDF <span class="math inline">\(\Phi_Z\)</span> of <span class="math inline">\(Z\sim \mathcal{N}(0,1)\)</span>, namely:</p>
<div class="img">
<div id="f857f868" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<p><img src="Lab6-solutions_files/figure-html/cell-2-output-1.png" width="684" height="404"></p>
</div>
</div>
</div>
<ul>
<li><p>If the test statistic <span class="math inline">\(z&lt;0\)</span>, then the area of the tail <strong>left</strong> to the <span class="math inline">\(z\)</span> is <span class="math inline">\(\Phi(z)=F_Z(z)\)</span>.</p></li>
<li><p>If the test statistic <span class="math inline">\(z&gt;0\)</span>, then the area of the tail <strong>right</strong> to the <span class="math inline">\(z\)</span> is <span class="math inline">\(1-\Phi(z)=1-F_Z(z)\)</span>.</p></li>
<li><p>If we consider the two-tailed case (e.g.&nbsp;the alternative hypothesis <span class="math inline">\(H_1\)</span> is <span class="math inline">\(\mu\neq\mu_0\)</span>), then <span class="math inline">\(p\)</span>-value is <strong>the sum of the tail pink areas</strong> (i.e.&nbsp;<span class="math inline">\(p\)</span> is twice bigger than each of them).</p></li>
<li><p>If we consider the one-tailed case (e.g.&nbsp;<span class="math inline">\(H_1\)</span> is <span class="math inline">\(\mu&lt;\mu_0\)</span> or <span class="math inline">\(H_1\)</span> is <span class="math inline">\(\mu&gt;\mu_0\)</span>), the <span class="math inline">\(p\)</span>-value is <strong>either of the (equal) tail pink areas</strong>.</p></li>
</ul>
</section>
<section id="significance-level-alphain01" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="significance-level-alphain01">3. Significance level <span class="math inline">\(\alpha\in(0,1)\)</span></h4>
<ul>
<li><p>We <strong>reject</strong> the null-hypothesis <span class="math inline">\(H_0\)</span> if <span class="math inline">\(p\leq \alpha\)</span>.</p></li>
<li><p>We <strong>do not reject</strong> the null-hypothesis <span class="math inline">\(H_0\)</span> if <span class="math inline">\(p&gt;\alpha\)</span>.</p></li>
</ul>
</section>
<section id="z-score-denoted-z_mathrmscore" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="z-score-denoted-z_mathrmscore">4. <span class="math inline">\(z\)</span>-score, denoted <span class="math inline">\(z_\mathrm{score}\)</span></h4>
<p><span class="math inline">\(z\)</span>-scores provide <strong>another</strong> approach to test the hypothesis (i.e.&nbsp;practically we calculate <strong>either</strong> <span class="math inline">\(p\)</span>-value <strong>or</strong> <span class="math inline">\(z\)</span>-score).</p>
<p>In simple words, <span class="math inline">\(z_\mathrm{score}\)</span> is the number such that its <span class="math inline">\(p\)</span>-value would be <span class="math inline">\(\alpha\)</span>. Therefore, to find <span class="math inline">\(z_\mathrm{score}\)</span>, we would use the inverse function to <span class="math inline">\(\Phi\)</span>, i.e.&nbsp;the percentile (see Lab 5). We will choose <span class="math inline">\(z_\mathrm{score}\)</span> so that its sign is the same as it is for the test statistic.</p>
<div class="img">
<div id="10ec88a3" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<p><img src="Lab6-solutions_files/figure-html/cell-3-output-1.png" width="684" height="419"></p>
</div>
</div>
</div>
<ul>
<li><p>We reject <span class="math inline">\(H_0\)</span>, if the test statistic <span class="math inline">\(z\)</span> is inside the critical region constructed by <span class="math inline">\(z_\mathrm{score}\)</span> (the pink area), i.e.&nbsp;if <span class="math inline">\(z&gt;z_\mathrm{score}&gt;0\)</span> or if <span class="math inline">\(z&lt;z_\mathrm{score}&lt;0\)</span>.</p></li>
<li><p>We do note reject <span class="math inline">\(H_0\)</span> otherwise.</p></li>
</ul>
</section>
</section>
<section id="example-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-1">Example 1</h3>
<p>Consider an example from the Lecture notes.</p>
<p>A machine produces items having a nominal mass of <span class="math inline">\(1\)</span> kg. The mass of a randomly selected item <span class="math inline">\(x\)</span> follows the distribution <span class="math inline">\(X\sim \mathcal{N}(\mu, 0.02^2)\)</span>. If <span class="math inline">\(\mu\neq 1\)</span> then the machinery should be corrected. The mean mass of a randomly sample of <span class="math inline">\(25\)</span> items was found to be <span class="math inline">\(0.989\)</span> kg. Test the null hypothesis that <span class="math inline">\(H_0:\mu=1\)</span> at the <span class="math inline">\(1\%\)</span> significance level.</p>
<p>Note that the alternative hypothesis here is <span class="math inline">\(\mu\neq1\)</span>, i.e.&nbsp;we deal with the two-tailed test.</p>
<p>We have</p>
<div id="fed3e901" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>xbar <span class="op">=</span> <span class="fl">0.989</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and we can calculate the test statistic. Recall that, for the square root function we need either use an additional module, e.g.&nbsp;<code>import numpy as np</code> and then <code>np.sqrt(n)</code> (this is reasonable in the case we use <code>numpy</code> also for some other purposes) or we just use that <span class="math inline">\(\sqrt{n}=n^{\frac12}\)</span>, namely, we write by <a href="#eq-z-stat" class="quarto-xref">Equation&nbsp;1</a>,</p>
<div id="cf0c1258" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> (xbar <span class="op">-</span> mu) <span class="op">/</span> (sigma <span class="op">/</span> (n <span class="op">**</span> <span class="fl">0.5</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>-2.750000000000002</code></pre>
</div>
</div>
<p>Since the test statistic is negative, to calculate the <span class="math inline">\(p\)</span>-value we consider the <span class="math inline">\(\Phi(z)\)</span>, and since this is the two-tailed case, we have that <span class="math inline">\(p=2\Phi(z)\)</span>. Namely, we calculate</p>
<div id="f7ff1c82" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> norm.cdf(z)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>0.0059595264701090694</code></pre>
</div>
</div>
<p>Since <span class="math inline">\(p &lt; \alpha = 0.01\)</span>, i.e.&nbsp;the significance of the <span class="math inline">\(p\)</span>-value is <strong>below</strong> the significance level, we reject <span class="math inline">\(H_0\)</span>.</p>
<p><strong>Alternatively</strong>, we can use the <span class="math inline">\(z\)</span>-score approach (<strong>that is exactly what you use doing calculations by hand and using the statistical tables</strong>), we need to use <code>norm.ppf</code> function (discussed on Lab 5); since this is the two-tailed case, we calculate it at <span class="math inline">\(\frac{\alpha}2\)</span>, that is then the area of the left pink tail on Figure 2, as we need to choose the negative <span class="math inline">\(z_\mathrm{score}\)</span>:</p>
<div id="a91cf78c" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>zscore <span class="op">=</span> norm.ppf(alpha<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>zscore</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>-2.575829303548901</code></pre>
</div>
</div>
<p>Since <span class="math inline">\(z&lt;z_\mathrm{score}\)</span>, i.e.&nbsp;the test statistic is <strong>inside</strong> the critical (left tail, left pink) region, we reject <span class="math inline">\(H_0\)</span>.</p>
</section>
<section id="example-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-2">Example 2</h3>
<p>The number of strokes a golfer takes to complete a round of golf has mean <span class="math inline">\(84.1\)</span> and standard deviation <span class="math inline">\(2.6\)</span>. After a month of holidays without playing golf her mean is now <span class="math inline">\(85.1\)</span> in <span class="math inline">\(36\)</span> subsequent rounds. At the <span class="math inline">\(5\%\)</span> significance level test the null hypothesis that her standard of play is unaltered against the alternative hypothesis that it became worse, i.e.</p>
<ul>
<li><p><span class="math inline">\(H_0: \mu=84.1\)</span></p></li>
<li><p><span class="math inline">\(H_1: \mu&gt;84.1\)</span> (one-tailed)</p></li>
</ul>
</section>
<section id="section" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="section"><span class="header-section-number">1.1</span> </h2>
<p>Calculate the test statistic and assign it to <code>z</code>.</p>
<div id="39ed142c" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="fl">84.1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">2.6</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">36</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>xbar <span class="op">=</span> <span class="fl">85.1</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> (xbar <span class="op">-</span> mu) <span class="op">/</span> (sigma <span class="op">/</span> (n <span class="op">**</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the answer:</p>
<div id="cb98b418" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>2.3076923076923075</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="section-1"><span class="header-section-number">1.2</span> </h2>
<p>Calculate the <span class="math inline">\(p\)</span>-value, taking into account that <span class="math inline">\(z&gt;0\)</span> and we test the one-tailed case.</p>
<div id="1cc8633d" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> norm.cdf(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the answer:</p>
<div id="86d68374" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>0.01050812811375934</code></pre>
</div>
</div>
<p>Since <span class="math inline">\(p&lt;0.05=\alpha\)</span>, we reject <span class="math inline">\(H_0\)</span>.</p>
</section>
<section id="section-2" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="section-2"><span class="header-section-number">1.3</span> </h2>
<p>Alternatively, calculate the <span class="math inline">\(z\)</span>-score correspondent to the considered significance level (and assign it to <code>zscore</code>). Note that we are going to compare the <span class="math inline">\(z\)</span>-score with the test statistic, hence, we will be looking for the positive <span class="math inline">\(z\)</span>-score (as the test statistic is positive).</p>
<div id="94bd167f" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>zscore <span class="op">=</span> norm.ppf(<span class="dv">1</span><span class="op">-</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the answer:</p>
<div id="95e65e30" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>zscore</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>1.6448536269514722</code></pre>
</div>
</div>
<p>Since <span class="math inline">\(0&lt;z_\mathrm{score}&lt;z\)</span>, we have that the test statistic is inside the critical (tail) region, and we will reject <span class="math inline">\(H_0\)</span>.</p>
</section>
</section>
<section id="t-tests-when-we-do-not-know-much-about-the-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> <span class="math inline">\(t\)</span>-tests (when we do not know much about the data)</h1>
<p>Usually, we have just the data (e.g.&nbsp;one or two samples). We may expect that the data is normally distributed (and there are some statistical tests to verify this — though, we will not consider them now), but we don’t know exactly e.g.&nbsp;the standard deviation of that distribution. Hence we need to guess that standard deviation from the sample standard deviation. This guess leads to errors. To take these potential errors into account, <span class="math inline">\(t\)</span>-tests are used.</p>
<p><span class="math inline">\(t\)</span>-tests are quite similar to <span class="math inline">\(z\)</span>-tests with two main differences:</p>
<ol type="1">
<li>Test statistic (denoted <span class="math inline">\(t\)</span> in the Lecture Notes) is calculated with the <strong>sample standard deviation</strong> <span class="math inline">\(s\)</span> (as we don’t know the population standard deviation <span class="math inline">\(\sigma\)</span>). E.g. in one-sample test we take</li>
</ol>
<p><span id="eq-t-stat"><span class="math display">\[
t=\frac{\bar{x}-\mu}{\dfrac{s}{\sqrt{n}}}
\tag{2}\]</span></span></p>
<ol start="2" type="1">
<li><span class="math inline">\(p\)</span>-value and <span class="math inline">\(t\)</span>-score are calculated for <span class="math inline">\(t\)</span>-distribution, instead of the standard normal distribution. The work with <span class="math inline">\(t\)</span>-distribution in Python is similar to any other distribution:</li>
</ol>
<div id="5a02dcde" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and then you can used <code>t.cdf(x, df)</code> or <code>t.pdf(x, df)</code> or <code>t.ppf(q, df)</code>, where <code>df</code> is the degree of freedoms. Before considering an example, we note that the name of the class for this distribution is just <code>t</code>, hence, <span style="color:red;"><strong>YOU SHOULD NOT USE</strong></span> <code>t</code> variable for the test statistic. We will use e.g.&nbsp;<code>tstat</code> instead.</p>
<section id="section-3" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="section-3"><span class="header-section-number">2.1</span> </h2>
<p>Download file <code>Heights.csv</code> from Canvas Week 6, upload it to Anaconda cloud, and load its content to Pandas data frame <code>df_heights</code> (see Lab 3 if you don’t remember how to do this).</p>
<div id="71f2f446" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df_heights <span class="op">=</span> pd.read_csv(<span class="st">'Heights.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the first rows to see the structure:</p>
<div id="2c0815cf" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_heights.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">HEIGHTS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6.50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>6.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>6.33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>6.50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6.42</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We assume that it is known that this sample of heights has normal distribution.</p>
</section>
<section id="section-4" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="section-4"><span class="header-section-number">2.2</span> </h2>
<p>Assign the values of the only column of this data frame to Numpy array <code>x</code>. Assign to <code>n</code> the size of the sample, i.e.&nbsp;the length of <code>x</code> using function <code>len</code>.</p>
<div id="2ce38c91" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_heights[<span class="st">'HEIGHTS'</span>].to_numpy()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>n  <span class="op">=</span> <span class="bu">len</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the answer:</p>
<div id="feebddc9" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>65</code></pre>
</div>
</div>
<p>Recall that, to calculate the sample standard deviation <span class="math inline">\(s\)</span> (that has <span class="math inline">\(n-1\)</span> in the denominator), we need to use the key <code>ddof = 1</code>, e.g.</p>
<div id="c92542b4" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>np.std(a, ddof <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>1.0</code></pre>
</div>
</div>
<p>Note that we can also write</p>
<div id="6108f7d1" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>a.std(ddof <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>1.0</code></pre>
</div>
</div>
<p>i.e.&nbsp;instead of applying function <code>np.std</code> to <code>a</code> we can use the property (method) <code>std</code> of the Numpy-array <code>a</code>. The same trick works for other statistical characteristics, e.g.&nbsp;<code>a.mean()</code> and <code>np.mean(a)</code> give the same.</p>
</section>
<section id="section-5" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="section-5"><span class="header-section-number">2.3</span> </h2>
<p>Assign to <code>xbar</code> the mean of <code>x</code>. Assign to <code>s</code> the sample standard deviation of <code>x</code>.</p>
<div id="52f75a0a" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="op">=</span> x.mean() <span class="co"># Or xbar = np.mean(x)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> x.std(ddof <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the answers:</p>
<div id="7c4e73e6" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>[xbar, s]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>[6.467692323784616, 0.3302970630589082]</code></pre>
</div>
</div>
</section>
<section id="section-6" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="section-6"><span class="header-section-number">2.4</span> </h2>
<p>We are going to use a one-sample <span class="math inline">\(t\)</span>-test to determine whether the heights in the data frame has a mean of <span class="math inline">\(\mu = 6.5\)</span>. Assign to <code>tstat</code> the corresponding test statistic, using <a href="#eq-t-stat" class="quarto-xref">Equation&nbsp;2</a>.</p>
<div id="03445a76" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="fl">6.5</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>tstat <span class="op">=</span> (xbar <span class="op">-</span> mu) <span class="op">/</span> (s <span class="op">/</span> np.sqrt(n)) <span class="co"># As numpy is anyway in use, or keep n ** 0.5 instead</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the answer</p>
<div id="5e07b2a1" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tstat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>-0.7886016620455049</code></pre>
</div>
</div>
<p>Here <span class="math inline">\(H_0: \mu=6.5\)</span> and <span class="math inline">\(H_1: \mu\neq 6.5\)</span>, i.e.&nbsp;we deal with the two-tailed test.</p>
<p>We can calculate <span class="math inline">\(p\)</span>-value, recall that for the one-sample test we should take <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom. Since the test statistic is negative, we have</p>
<div id="98984925" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> t.cdf(tstat, df <span class="op">=</span> n<span class="op">-</span><span class="dv">1</span>) </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>0.433256350170654</code></pre>
</div>
</div>
<p>Therefore, if we consider any significance level below this <span class="math inline">\(p\)</span>: e.g.&nbsp;<span class="math inline">\(5\%=0.05\)</span>, then we do not have any evidence to reject <span class="math inline">\(H_0\)</span>.</p>
<p><strong>Alternatively</strong>, we calculate the <span class="math inline">\(t\)</span>-score corresponding to the chosen significance level, e.g.&nbsp;<span class="math inline">\(\alpha = 0.05\)</span>. Since this is two-tailed test, we calculate the percentile at <span class="math inline">\(\frac{\alpha}{2}\)</span>:</p>
<div id="3471c123" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>tscore <span class="op">=</span> t.ppf(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>, df <span class="op">=</span> n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>tscore</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>-1.9977296536259739</code></pre>
</div>
</div>
<p>Since (the negative) <span class="math inline">\(t\)</span>-score is smaller than (the negative) <span class="math inline">\(t\)</span>-statistic, the latter lies outside of the critical interval, and again, we can’t reject <span class="math inline">\(H_0\)</span>.</p>
<p>Apparently, <code>scipy.stats</code> module proposes a faster way to calculate both the test statistic and the <span class="math inline">\(p\)</span>-value for the <span class="math inline">\(1\)</span>-sample <span class="math inline">\(t\)</span>-test:</p>
<div id="8e6c094f" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ttest_1samp</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="fl">6.5</span> <span class="co"># If you haven't assign it before</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>ttest_1samp(x, mu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>Ttest_1sampResult(statistic=-0.7886016620455049, pvalue=0.433256350170654)</code></pre>
</div>
</div>
<p>Surely the answers are the same as we found previously. They are also accessible directly:</p>
<div id="0918c808" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> ttest_1samp(x, mu)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>results.pvalue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>0.433256350170654</code></pre>
</div>
</div>
<p>(and similarly for <code>results.statistic</code>).</p>
</section>
<section id="section-7" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="section-7"><span class="header-section-number">2.5</span> </h2>
<p>Download the file <code>HealthData.csv</code> from Canvas Week 6, upload it to Anaconda.cloud, and consider the column <code>DENSITY</code>. Use a one-sample <span class="math inline">\(t\)</span>-test to determine whether the density variable in the data set Health Data has a mean of <span class="math inline">\(1.051\)</span> using the <span class="math inline">\(5\)</span>% significance level. Assign the corresponding <span class="math inline">\(p\)</span>-value to <code>p</code> (you may use either of the considered approaches).</p>
<div id="6c5bea36" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df_health <span class="op">=</span> pd.read_csv(<span class="st">'HealthData.csv'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_health[<span class="st">'DENSITY'</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="fl">1.051</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> ttest_1samp(x, mu)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> results.pvalue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the answer:</p>
<div id="300b5bf4" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>0.00017145125375254356</code></pre>
</div>
</div>
<p>As you can see <span class="math inline">\(p\)</span>-value is less than the significance level: surely, you check this in Python :-)</p>
<div id="7532e234" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;</span> <span class="fl">0.05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>True</code></pre>
</div>
</div>
<p>Hence, we reject the null-hypothesis that <span class="math inline">\(\mu=1.051\)</span>.</p>
<section id="two-sample-test" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="two-sample-test">Two-sample test</h3>
<p>We consider now examples of two-sample tests.</p>
<p>First, we will use a paired <span class="math inline">\(t\)</span>-test to determine whether there is any difference in the two processes (Process A and Process B) of preserving meat joints. This data can be found in <code>MeatJoints.csv</code> file (Canvas Week 6), and we will test at the 5% significance level whether the means of the two processes are equal.</p>
<p>So, we have <span class="math inline">\(H_0: \mu_A=\mu_B\)</span> and <span class="math inline">\(H_1: \mu_A\neq \mu_B\)</span>.</p>
</section>
</section>
<section id="section-8" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="section-8"><span class="header-section-number">2.6</span> </h2>
<p>Load the the data to Anaconda.cloud, and assign to <span class="math inline">\(a\)</span> the column <code>Process A</code> and to <span class="math inline">\(b\)</span> the column <code>Process B</code>.</p>
<div id="4a4ffb64" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df_meat <span class="op">=</span> pd.read_csv(<span class="st">'MeatJoints.csv'</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> df_meat[<span class="st">'Process A'</span>].to_numpy()</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> df_meat[<span class="st">'Process B'</span>].to_numpy() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then use the following command to apply two-sample test</p>
<div id="18ff2c1b" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ttest_rel</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> ttest_rel(a,b)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>Ttest_relResult(statistic=-2.29517764444372, pvalue=0.047371692861499864)</code></pre>
</div>
</div>
<p>Since</p>
<div id="246ed31f" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>results.pvalue <span class="op">&lt;</span> <span class="fl">0.05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>True</code></pre>
</div>
</div>
<p>we reject <span class="math inline">\(H_0\)</span>.</p>
</section>
</section>
<section id="if-you-have-time" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> If you have time</h1>
<p>Next, we consider an unpaired test on the dataset <code>SportHeights.csv</code> (also available in Canvas Week 6). We will use an unpaired <span class="math inline">\(t\)</span>-test at the 5% significance level to determine whether there is a difference in the mean height between basketball and football players.</p>
<section id="section-9" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="section-9"><span class="header-section-number">3.1</span> </h2>
<p>Load the file to Anaconda.cloud and assign to <code>f</code> the heights of football players and to <code>b</code> the heights of basketball players.</p>
<div id="c9a6ef51" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df_sport <span class="op">=</span> pd.read_csv(<span class="st">'SportHeights.csv'</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> df_sport[<span class="st">'football'</span>].to_numpy()</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> df_sport[<span class="st">'basketball'</span>].to_numpy() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then perform the following test:</p>
<div id="7f1aff13" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ttest_ind</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> ttest_ind(f, b, nan_policy<span class="op">=</span><span class="st">'omit'</span>) </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>Ttest_indResult(statistic=-3.684107948156318, pvalue=0.00040777606606915177)</code></pre>
</div>
</div>
<p>Note the key <code>nan_policy='omit'</code> as <code>b</code> and <code>f</code> have different sizes here.</p>
<p>Since</p>
<div id="7f17f22d" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>results.pvalue <span class="op">&lt;</span> <span class="fl">0.05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>True</code></pre>
</div>
</div>
<p>we reject the null hypothesis that the mean heights of basketball and football players are equal.</p>
</section>
</section>
<section id="if-you-have-more-time" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> If you have more time</h1>
<p>The PDF of <span class="math inline">\(t\)</span>-distribution has heavier (“thicker”) tails than the standard normal distribution: the following picture compare PDFs for <span class="math inline">\(Z\sim \mathcal{N}(0,1)\)</span> and <span class="math inline">\(X\sim t_1\)</span> (the <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(1\)</span> degree of freedom).</p>
<div id="5455308e" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1000</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x, norm.pdf(x), color <span class="op">=</span> <span class="st">'b'</span>, label <span class="op">=</span> <span class="vs">r'$y = f_Z(x), Z\sim \mathcal</span><span class="sc">{N}</span><span class="vs">(0,1)$'</span>) </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>plt.plot(x, t.pdf(x, df <span class="op">=</span> <span class="dv">1</span>), color <span class="op">=</span> <span class="st">'r'</span>, label <span class="op">=</span> <span class="vs">r'$y = f_X(x), X\sim t_1$'</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lab6-solutions_files/figure-html/cell-38-output-1.png" width="579" height="404"></p>
</div>
</div>
<p>Recall that the chosen degree of freedom depends on the sample size. If degree of freedom is increasing, the <span class="math inline">\(t\)</span>-distribution becomes closer to the `standard normal distribution:</p>
<div id="ac9701b6" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1000</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> norm.pdf(x)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x, norm.pdf(x), color <span class="op">=</span> <span class="st">'b'</span>, label <span class="op">=</span> <span class="vs">r'$y = f_Z(x), Z\sim \mathcal</span><span class="sc">{N}</span><span class="vs">(0,1)$'</span>) </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'r'</span>, <span class="st">'y'</span>,<span class="st">'g'</span>]</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> <span class="dv">3</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, t.pdf(x, df <span class="op">=</span> j), color <span class="op">=</span> colors[i], label <span class="op">=</span> <span class="ss">f'$y = f_X(x), X\sim t_</span><span class="ch">{{</span><span class="sc">{</span>j<span class="sc">}</span><span class="ch">}}</span><span class="ss">$'</span>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lab6-solutions_files/figure-html/cell-39-output-1.png" width="579" height="404"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>